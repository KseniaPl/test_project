[2021-09-30 19:22:14,268] {taskinstance.py:896} INFO - Dependencies all met for <TaskInstance: etl_dag.run_hive 2021-09-28T00:00:00+00:00 [queued]>
[2021-09-30 19:22:14,331] {taskinstance.py:896} INFO - Dependencies all met for <TaskInstance: etl_dag.run_hive 2021-09-28T00:00:00+00:00 [queued]>
[2021-09-30 19:22:14,332] {taskinstance.py:1087} INFO - 
--------------------------------------------------------------------------------
[2021-09-30 19:22:14,332] {taskinstance.py:1088} INFO - Starting attempt 1 of 1
[2021-09-30 19:22:14,332] {taskinstance.py:1089} INFO - 
--------------------------------------------------------------------------------
[2021-09-30 19:22:14,360] {taskinstance.py:1107} INFO - Executing <Task(PythonOperator): run_hive> on 2021-09-28T00:00:00+00:00
[2021-09-30 19:22:14,364] {standard_task_runner.py:52} INFO - Started process 1700823 to run task
[2021-09-30 19:22:14,373] {standard_task_runner.py:76} INFO - Running: ['airflow', 'tasks', 'run', 'etl_dag', 'run_hive', '2021-09-28T00:00:00+00:00', '--job-id', '423', '--pool', 'default_pool', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmpy_d0kikf', '--error-file', '/tmp/tmpcmvji85r']
[2021-09-30 19:22:14,373] {standard_task_runner.py:77} INFO - Job 423: Subtask run_hive
[2021-09-30 19:22:14,454] {logging_mixin.py:104} INFO - Running <TaskInstance: etl_dag.run_hive 2021-09-28T00:00:00+00:00 [running]> on host kseniya-B85M-D3V
[2021-09-30 19:22:14,609] {taskinstance.py:1300} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=etl_dag
AIRFLOW_CTX_TASK_ID=run_hive
AIRFLOW_CTX_EXECUTION_DATE=2021-09-28T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-09-28T00:00:00+00:00
[2021-09-30 19:22:14,610] {hive_task.py:8} INFO - hive task started
[2021-09-30 19:22:28,960] {hive_task.py:15} INFO - before sql
[2021-09-30 19:22:49,816] {hive_task.py:21} INFO - before load
[2021-09-30 19:22:52,353] {hive_task.py:24} INFO - after load
[2021-09-30 19:22:56,893] {logging_mixin.py:104} INFO - +--------+------+---------------+--------------------+---------+--------------------+----------+----------+----------+--------------------+-----------+---------+------+--------+-------------------+----+-----------+--------------------+---------+---------+--------+
|      id|region|           city|                name| employer|               title|createdAtD|createdAtM|createdAtY|                spec|salary_from|salary_to|   exp|currency|          skillsstr|mode|   schedule|         description|      lat|     long|category|
+--------+------+---------------+--------------------+---------+--------------------+----------+----------+----------+--------------------+-----------+---------+------+--------+-------------------+----+-----------+--------------------+---------+---------+--------+
|    null|region|           city|                name| employer|               title|      null|      null|      null|                spec|       null|     null|   exp|currency|          skillsstr|mode|   schedule|         description|      lat|     long|category|
|42642250|    nn|               |                РЭДИ| 577825.0|   Программист C/С++|        26|         5|      2021|Передача данных и...|          0|        0|intern|        |   arm:c#:c#:python|full|    fullDay|<p><strong>Уважае...|         |         |     lib|
|43562672|    nn|Нижний Новгород|            МФИ Софт|  12878.0|Старший инженер-п...|        20|         5|      2021|Программирование....|          0|        0|senior|        |          c++:linux|full|   flexible|<p><strong>МФИ Со...| 56.29008|43.985532|     lib|
|44461719|    nn|               |          ЭР-Телеком|  44272.0|Руководитель прое...|        11|         5|      2021|Управление проект...|          0|        0|junior|        |                sap|full|    fullDay|<p><strong>Функци...|         |         |  manage|
|44498002|    nn|               |Железов Артем Сер...|4642647.0|Cloud Engineering...|        11|         5|      2021|Компьютерная безо...|     250000|   500000|middle|     RUR|architect:aws:cloud|full|     remote|<p><strong>Привет...|         |         |     dsa|
|44743340|    nn|      Дзержинск|          Ростелеком|   2748.0|Техник по подключ...|        20|         5|      2021|Сервисный инженер...|      30000|        0|intern|     RUR|                   |full|    fullDay|<p><strong>Ростел...|56.249061| 43.46123| service|
|42543706|    nn|               |          Devexperts|  52729.0|Специалист технич...|        28|         5|      2021| Поддержка. Helpdesk|          0|        0|junior|        |            fintech|full|     remote|<p><strong>Мы</st...|         |         |    help|
|41763740|    nn|               |       Смарт-Контакт|1813879.0|    Java-разработчик|        18|         5|      2021|Программирование....|          0|        0|senior|        |        java:spring|full|     remote|<p>На текущий мом...|         |         |      ee|
|44183188|    nn|               |         Союзрешение|4652608.0|Программист-разра...|        26|         4|      2021|Программирование....|      84000|   117600|middle|     RUR|                 1c|part|     remote|<p>Мы. компания С...|         |         |  integr|
|44330398|    nn|               |              Skyeng|1122462.0|      Куратор Skypro|        30|         4|      2021| Поддержка. Helpdesk|      30000|    50000|junior|     RUR|                   |full|     remote|<p>В команду <str...|         |         |     out|
|44951418|    nn|Нижний Новгород|               НИТЭК| 735972.0|Младший программи...|        27|         5|      2021|Начальный уровень...|      30000|        0|junior|     RUR|                 1c|full|    fullDay|<strong>Обязаннос...|56.344895|43.898269|  integr|
|44974710|    nn|               |      Антигравитация|2639962.0|Менеджер по прода...|        28|         5|      2021|Начальный уровень...|      45000|        0|junior|     RUR|                crm|full|     remote|<p>Ищем <strong>М...|         |         |   sales|
|43276255|    nn|Нижний Новгород|         КТБ Эксперт|5206622.0|Руководитель груп...|        27|         5|      2021|Языки:Письменный ...|          0|        0|junior|        |                   |full|    fullDay|<strong>Обязаннос...|56.244955|43.972425|     out|
|43512112|    nn|               |      ЛинкТелеком НН|1146834.0|Системный админис...|        31|         5|      2021|Сетевые технологи...|      60000|        0|middle|     RUR|               voip|full|    fullDay|<strong>Обязаннос...|         |         |   admin|
|44908482|    nn|               |      МетМашКомплект|5156170.0|Оператор обрабаты...|        26|         5|      2021|Машиностроение:Ин...|          0|    94000|junior|     RUR|                   |full|flyInFlyOut|<p>На крупное маш...|         |         |engineer|
|42632487|    nn|               |          Доктор Веб|   8884.0|Региональный мене...|        31|         5|      2021|Компьютерные прог...|      40000|        0|junior|     RUR|                   |full|    fullDay|<strong>Обязаннос...|         |         |   sales|
|43761055|    nn|Нижний Новгород|РОСБАНК. Societe ...|    599.0|       Разработчик C|        25|         5|      2021|Программирование....|          0|        0|junior|        |                  c|full|    fullDay|<strong>Обязаннос...|56.307302|44.079855|   multi|
|39731593|    nn|Нижний Новгород|             Biglion| 656481.0|Менеджер по разви...|        27|         5|      2021|Услуги для бизнес...|      50000|        0|intern|     RUR|                   |full|    fullDay|<p><br /><br /><s...|56.311331|44.030088|   sales|
|40893554|    nn|     село Усады|        ICL Services| 156424.0|Системный админис...|        12|         5|      2021|Системный админис...|          0|        0|junior|        |          c:windows|full|     remote|<p><em>В команду ...|55.673087|49.213826|   admin|
|44389738|    nn|Нижний Новгород|                 МТС|   3776.0|Специалист технич...|        11|         5|      2021|Информационные те...|          0|        0|intern|        |                   |full|      shift|<p><strong>МТС – ...|56.293956|44.023728|    help|
+--------+------+---------------+--------------------+---------+--------------------+----------+----------+----------+--------------------+-----------+---------+------+--------+-------------------+----+-----------+--------------------+---------+---------+--------+
only showing top 20 rows
[2021-09-30 19:22:56,894] {logging_mixin.py:104} INFO - 
[2021-09-30 19:23:17,334] {logging_mixin.py:104} INFO - +---------+---------------+
| category|count(category)|
+---------+---------------+
|     null|              0|
|    admin|          11430|
|   analit|           3405|
|      arh|            615|
| category|             15|
|       db|           1425|
|   design|           2175|
|   devops|           2565|
|  digital|           5085|
|      dsa|           6240|
|       ee|           4230|
| engineer|          13785|
|hb_manage|           1950|
|     help|           4875|
|   help_1|           4125|
|   help_2|             30|
|   integr|          10950|
|      lib|           1920|
|   manage|           3030|
|   mobile|           3825|
+---------+---------------+
only showing top 20 rows
[2021-09-30 19:23:17,338] {logging_mixin.py:104} INFO - 
[2021-09-30 19:23:20,559] {logging_mixin.py:104} INFO - +------+----------+
|   exp|count(exp)|
+------+----------+
|intern|       975|
|junior|      7530|
|middle|      6255|
|senior|      1830|
+------+----------+
[2021-09-30 19:23:20,559] {logging_mixin.py:104} INFO - 
[2021-09-30 19:23:24,556] {logging_mixin.py:104} INFO - +--------------------+-----------+
|                name|count(name)|
+--------------------+-----------+
|              Яндекс|       5670|
|                 МТС|       3270|
|              Билайн|       2880|
|Центр разработки ...|       2250|
|          Ростелеком|       1890|
|Netcracker Techno...|       1860|
|   Intel Corporation|       1245|
|Кадровое агентств...|       1185|
|               ЛАНИТ|       1140|
|              Auriga|       1125|
|            Гринатом|       1065|
|        IT_Selection|       1035|
|            Сбербанк|       1035|
|              Skyeng|       1020|
|                 ГАЗ|       1020|
|                 IBS|        945|
|          ЭР-Телеком|        885|
|             МегаФон|        825|
|Positive Technolo...|        795|
|                 ЛАД|        765|
+--------------------+-----------+
only showing top 20 rows
[2021-09-30 19:23:24,556] {logging_mixin.py:104} INFO - 
[2021-09-30 19:23:28,307] {logging_mixin.py:104} INFO - +----------------------------------------------+---------------------------------------------+----------------------------------------------+
|percentile(salary_to, CAST(0.25 AS DOUBLE), 1)|percentile(salary_to, CAST(0.5 AS DOUBLE), 1)|percentile(salary_to, CAST(0.75 AS DOUBLE), 1)|
+----------------------------------------------+---------------------------------------------+----------------------------------------------+
|                                       50000.0|                                      80000.0|                                      120000.0|
|                                       60000.0|                                      91000.0|                                      150000.0|
|                                      130000.0|                                     150000.0|                                      200000.0|
|                                      100000.0|                                     200000.0|                                      250000.0|
+----------------------------------------------+---------------------------------------------+----------------------------------------------+
[2021-09-30 19:23:28,308] {logging_mixin.py:104} INFO - 
[2021-09-30 19:23:28,308] {python.py:151} INFO - Done. Returned value was: None
[2021-09-30 19:23:28,340] {taskinstance.py:1204} INFO - Marking task as SUCCESS. dag_id=etl_dag, task_id=run_hive, execution_date=20210928T000000, start_date=20210930T162214, end_date=20210930T162328
[2021-09-30 19:23:28,688] {taskinstance.py:1265} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2021-09-30 19:23:28,728] {local_task_job.py:149} INFO - Task exited with return code 0
[2021-09-30 19:24:05,465] {taskinstance.py:896} INFO - Dependencies all met for <TaskInstance: etl_dag.run_hive 2021-09-28T00:00:00+00:00 [queued]>
[2021-09-30 19:24:05,504] {taskinstance.py:896} INFO - Dependencies all met for <TaskInstance: etl_dag.run_hive 2021-09-28T00:00:00+00:00 [queued]>
[2021-09-30 19:24:05,504] {taskinstance.py:1087} INFO - 
--------------------------------------------------------------------------------
[2021-09-30 19:24:05,504] {taskinstance.py:1088} INFO - Starting attempt 1 of 1
[2021-09-30 19:24:05,504] {taskinstance.py:1089} INFO - 
--------------------------------------------------------------------------------
[2021-09-30 19:24:05,522] {taskinstance.py:1107} INFO - Executing <Task(PythonOperator): run_hive> on 2021-09-28T00:00:00+00:00
[2021-09-30 19:24:05,529] {standard_task_runner.py:52} INFO - Started process 1705039 to run task
[2021-09-30 19:24:05,542] {standard_task_runner.py:76} INFO - Running: ['airflow', 'tasks', 'run', 'etl_dag', 'run_hive', '2021-09-28T00:00:00+00:00', '--job-id', '428', '--pool', 'default_pool', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmpc_46o9mw', '--error-file', '/tmp/tmpnxqp16c4']
[2021-09-30 19:24:05,543] {standard_task_runner.py:77} INFO - Job 428: Subtask run_hive
[2021-09-30 19:24:05,627] {logging_mixin.py:104} INFO - Running <TaskInstance: etl_dag.run_hive 2021-09-28T00:00:00+00:00 [running]> on host kseniya-B85M-D3V
[2021-09-30 19:24:05,753] {taskinstance.py:1300} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=etl_dag
AIRFLOW_CTX_TASK_ID=run_hive
AIRFLOW_CTX_EXECUTION_DATE=2021-09-28T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-09-28T00:00:00+00:00
[2021-09-30 19:24:05,754] {hive_task.py:8} INFO - hive task started
[2021-09-30 19:24:14,296] {hive_task.py:15} INFO - before sql
[2021-09-30 19:24:26,570] {hive_task.py:21} INFO - before load
[2021-09-30 19:24:28,207] {hive_task.py:24} INFO - after load
[2021-09-30 19:24:31,890] {logging_mixin.py:104} INFO - +--------+------+---------------+--------------------+---------+--------------------+----------+----------+----------+--------------------+-----------+---------+------+--------+-------------------+----+-----------+--------------------+---------+---------+--------+
|      id|region|           city|                name| employer|               title|createdAtD|createdAtM|createdAtY|                spec|salary_from|salary_to|   exp|currency|          skillsstr|mode|   schedule|         description|      lat|     long|category|
+--------+------+---------------+--------------------+---------+--------------------+----------+----------+----------+--------------------+-----------+---------+------+--------+-------------------+----+-----------+--------------------+---------+---------+--------+
|    null|region|           city|                name| employer|               title|      null|      null|      null|                spec|       null|     null|   exp|currency|          skillsstr|mode|   schedule|         description|      lat|     long|category|
|42642250|    nn|               |                РЭДИ| 577825.0|   Программист C/С++|        26|         5|      2021|Передача данных и...|          0|        0|intern|        |   arm:c#:c#:python|full|    fullDay|<p><strong>Уважае...|         |         |     lib|
|43562672|    nn|Нижний Новгород|            МФИ Софт|  12878.0|Старший инженер-п...|        20|         5|      2021|Программирование....|          0|        0|senior|        |          c++:linux|full|   flexible|<p><strong>МФИ Со...| 56.29008|43.985532|     lib|
|44461719|    nn|               |          ЭР-Телеком|  44272.0|Руководитель прое...|        11|         5|      2021|Управление проект...|          0|        0|junior|        |                sap|full|    fullDay|<p><strong>Функци...|         |         |  manage|
|44498002|    nn|               |Железов Артем Сер...|4642647.0|Cloud Engineering...|        11|         5|      2021|Компьютерная безо...|     250000|   500000|middle|     RUR|architect:aws:cloud|full|     remote|<p><strong>Привет...|         |         |     dsa|
|44743340|    nn|      Дзержинск|          Ростелеком|   2748.0|Техник по подключ...|        20|         5|      2021|Сервисный инженер...|      30000|        0|intern|     RUR|                   |full|    fullDay|<p><strong>Ростел...|56.249061| 43.46123| service|
|42543706|    nn|               |          Devexperts|  52729.0|Специалист технич...|        28|         5|      2021| Поддержка. Helpdesk|          0|        0|junior|        |            fintech|full|     remote|<p><strong>Мы</st...|         |         |    help|
|41763740|    nn|               |       Смарт-Контакт|1813879.0|    Java-разработчик|        18|         5|      2021|Программирование....|          0|        0|senior|        |        java:spring|full|     remote|<p>На текущий мом...|         |         |      ee|
|44183188|    nn|               |         Союзрешение|4652608.0|Программист-разра...|        26|         4|      2021|Программирование....|      84000|   117600|middle|     RUR|                 1c|part|     remote|<p>Мы. компания С...|         |         |  integr|
|44330398|    nn|               |              Skyeng|1122462.0|      Куратор Skypro|        30|         4|      2021| Поддержка. Helpdesk|      30000|    50000|junior|     RUR|                   |full|     remote|<p>В команду <str...|         |         |     out|
|44951418|    nn|Нижний Новгород|               НИТЭК| 735972.0|Младший программи...|        27|         5|      2021|Начальный уровень...|      30000|        0|junior|     RUR|                 1c|full|    fullDay|<strong>Обязаннос...|56.344895|43.898269|  integr|
|44974710|    nn|               |      Антигравитация|2639962.0|Менеджер по прода...|        28|         5|      2021|Начальный уровень...|      45000|        0|junior|     RUR|                crm|full|     remote|<p>Ищем <strong>М...|         |         |   sales|
|43276255|    nn|Нижний Новгород|         КТБ Эксперт|5206622.0|Руководитель груп...|        27|         5|      2021|Языки:Письменный ...|          0|        0|junior|        |                   |full|    fullDay|<strong>Обязаннос...|56.244955|43.972425|     out|
|43512112|    nn|               |      ЛинкТелеком НН|1146834.0|Системный админис...|        31|         5|      2021|Сетевые технологи...|      60000|        0|middle|     RUR|               voip|full|    fullDay|<strong>Обязаннос...|         |         |   admin|
|44908482|    nn|               |      МетМашКомплект|5156170.0|Оператор обрабаты...|        26|         5|      2021|Машиностроение:Ин...|          0|    94000|junior|     RUR|                   |full|flyInFlyOut|<p>На крупное маш...|         |         |engineer|
|42632487|    nn|               |          Доктор Веб|   8884.0|Региональный мене...|        31|         5|      2021|Компьютерные прог...|      40000|        0|junior|     RUR|                   |full|    fullDay|<strong>Обязаннос...|         |         |   sales|
|43761055|    nn|Нижний Новгород|РОСБАНК. Societe ...|    599.0|       Разработчик C|        25|         5|      2021|Программирование....|          0|        0|junior|        |                  c|full|    fullDay|<strong>Обязаннос...|56.307302|44.079855|   multi|
|39731593|    nn|Нижний Новгород|             Biglion| 656481.0|Менеджер по разви...|        27|         5|      2021|Услуги для бизнес...|      50000|        0|intern|     RUR|                   |full|    fullDay|<p><br /><br /><s...|56.311331|44.030088|   sales|
|40893554|    nn|     село Усады|        ICL Services| 156424.0|Системный админис...|        12|         5|      2021|Системный админис...|          0|        0|junior|        |          c:windows|full|     remote|<p><em>В команду ...|55.673087|49.213826|   admin|
|44389738|    nn|Нижний Новгород|                 МТС|   3776.0|Специалист технич...|        11|         5|      2021|Информационные те...|          0|        0|intern|        |                   |full|      shift|<p><strong>МТС – ...|56.293956|44.023728|    help|
+--------+------+---------------+--------------------+---------+--------------------+----------+----------+----------+--------------------+-----------+---------+------+--------+-------------------+----+-----------+--------------------+---------+---------+--------+
only showing top 20 rows
[2021-09-30 19:24:31,890] {logging_mixin.py:104} INFO - 
[2021-09-30 19:24:40,170] {logging_mixin.py:104} INFO - +---------+---------------+
| category|count(category)|
+---------+---------------+
|     null|              0|
|    admin|          12192|
|   analit|           3632|
|      arh|            656|
| category|             16|
|       db|           1520|
|   design|           2320|
|   devops|           2736|
|  digital|           5424|
|      dsa|           6656|
|       ee|           4512|
| engineer|          14704|
|hb_manage|           2080|
|     help|           5200|
|   help_1|           4400|
|   help_2|             32|
|   integr|          11680|
|      lib|           2048|
|   manage|           3232|
|   mobile|           4080|
+---------+---------------+
only showing top 20 rows
[2021-09-30 19:24:40,170] {logging_mixin.py:104} INFO - 
[2021-09-30 19:24:41,195] {local_task_job.py:197} WARNING - State of this instance has been externally set to None. Terminating instance.
[2021-09-30 19:24:41,226] {process_utils.py:100} INFO - Sending Signals.SIGTERM to GPID 1705039
[2021-09-30 19:24:41,226] {taskinstance.py:1284} ERROR - Received SIGTERM. Terminating subprocesses.
[2021-09-30 19:24:41,226] {java_gateway.py:1210} INFO - Error while receiving.
Traceback (most recent call last):
  File "/home/kseniya/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1200, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.8/socket.py", line 669, in readinto
    return self._sock.recv_into(b)
  File "/usr/local/lib/python3.8/dist-packages/airflow/models/taskinstance.py", line 1286, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal
[2021-09-30 19:24:41,229] {java_gateway.py:1050} ERROR - Exception while sending command.
Traceback (most recent call last):
  File "/home/kseniya/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1200, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/usr/lib/python3.8/socket.py", line 669, in readinto
    return self._sock.recv_into(b)
  File "/usr/local/lib/python3.8/dist-packages/airflow/models/taskinstance.py", line 1286, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kseniya/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1033, in send_command
    response = connection.send_command(command)
  File "/home/kseniya/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1211, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while receiving
[2021-09-30 19:24:41,230] {taskinstance.py:1501} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/airflow/models/taskinstance.py", line 1157, in _run_raw_task
    self._prepare_and_execute_task_with_callbacks(context, task)
  File "/usr/local/lib/python3.8/dist-packages/airflow/models/taskinstance.py", line 1331, in _prepare_and_execute_task_with_callbacks
    result = self._execute_task(context, task_copy)
  File "/usr/local/lib/python3.8/dist-packages/airflow/models/taskinstance.py", line 1361, in _execute_task
    result = task_copy.execute(context=context)
  File "/usr/local/lib/python3.8/dist-packages/airflow/operators/python.py", line 150, in execute
    return_value = self.execute_callable()
  File "/usr/local/lib/python3.8/dist-packages/airflow/operators/python.py", line 161, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/kseniya/airflow/dags/scripts/hive_task.py", line 27, in hive_task
    spark.sql("SELECT exp, count(exp) FROM vac  WHERE category ='web' group by exp order by exp").show()
  File "/home/kseniya/.local/lib/python3.8/site-packages/pyspark/sql/dataframe.py", line 484, in show
    print(self._jdf.showString(n, 20, vertical))
  File "/home/kseniya/.local/lib/python3.8/site-packages/py4j/java_gateway.py", line 1304, in __call__
    return_value = get_return_value(
  File "/home/kseniya/.local/lib/python3.8/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/home/kseniya/.local/lib/python3.8/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o31.showString
[2021-09-30 19:24:41,252] {taskinstance.py:1544} INFO - Marking task as FAILED. dag_id=etl_dag, task_id=run_hive, execution_date=20210928T000000, start_date=20210930T162405, end_date=20210930T162441
[2021-09-30 19:24:41,543] {process_utils.py:66} INFO - Process psutil.Process(pid=1705039, status='terminated', exitcode=1, started='19:24:05') (1705039) terminated with exit code 1
[2021-09-30 19:24:42,511] {process_utils.py:66} INFO - Process psutil.Process(pid=1705051, status='terminated', started='19:24:05') (1705051) terminated with exit code None
[2021-09-30 19:28:05,674] {taskinstance.py:896} INFO - Dependencies all met for <TaskInstance: etl_dag.run_hive 2021-09-28T00:00:00+00:00 [queued]>
[2021-09-30 19:28:05,711] {taskinstance.py:896} INFO - Dependencies all met for <TaskInstance: etl_dag.run_hive 2021-09-28T00:00:00+00:00 [queued]>
[2021-09-30 19:28:05,711] {taskinstance.py:1087} INFO - 
--------------------------------------------------------------------------------
[2021-09-30 19:28:05,711] {taskinstance.py:1088} INFO - Starting attempt 1 of 1
[2021-09-30 19:28:05,712] {taskinstance.py:1089} INFO - 
--------------------------------------------------------------------------------
[2021-09-30 19:28:05,727] {taskinstance.py:1107} INFO - Executing <Task(PythonOperator): run_hive> on 2021-09-28T00:00:00+00:00
[2021-09-30 19:28:05,734] {standard_task_runner.py:52} INFO - Started process 1716256 to run task
[2021-09-30 19:28:05,755] {standard_task_runner.py:76} INFO - Running: ['airflow', 'tasks', 'run', 'etl_dag', 'run_hive', '2021-09-28T00:00:00+00:00', '--job-id', '442', '--pool', 'default_pool', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmpnicskpi4', '--error-file', '/tmp/tmp2611de41']
[2021-09-30 19:28:05,756] {standard_task_runner.py:77} INFO - Job 442: Subtask run_hive
[2021-09-30 19:28:05,859] {logging_mixin.py:104} INFO - Running <TaskInstance: etl_dag.run_hive 2021-09-28T00:00:00+00:00 [running]> on host kseniya-B85M-D3V
[2021-09-30 19:28:05,983] {taskinstance.py:1300} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=etl_dag
AIRFLOW_CTX_TASK_ID=run_hive
AIRFLOW_CTX_EXECUTION_DATE=2021-09-28T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-09-28T00:00:00+00:00
[2021-09-30 19:28:05,984] {hive_task.py:8} INFO - hive task started
[2021-09-30 19:28:15,849] {hive_task.py:15} INFO - before sql
[2021-09-30 19:28:29,110] {hive_task.py:21} INFO - before load
[2021-09-30 19:28:31,107] {hive_task.py:24} INFO - after load
[2021-09-30 19:28:34,343] {logging_mixin.py:104} INFO - +--------+------+---------------+--------------------+---------+--------------------+----------+----------+----------+--------------------+-----------+---------+------+--------+-------------------+----+-----------+--------------------+---------+---------+--------+
|      id|region|           city|                name| employer|               title|createdAtD|createdAtM|createdAtY|                spec|salary_from|salary_to|   exp|currency|          skillsstr|mode|   schedule|         description|      lat|     long|category|
+--------+------+---------------+--------------------+---------+--------------------+----------+----------+----------+--------------------+-----------+---------+------+--------+-------------------+----+-----------+--------------------+---------+---------+--------+
|    null|region|           city|                name| employer|               title|      null|      null|      null|                spec|       null|     null|   exp|currency|          skillsstr|mode|   schedule|         description|      lat|     long|category|
|42642250|    nn|               |                РЭДИ| 577825.0|   Программист C/С++|        26|         5|      2021|Передача данных и...|          0|        0|intern|        |   arm:c#:c#:python|full|    fullDay|<p><strong>Уважае...|         |         |     lib|
|43562672|    nn|Нижний Новгород|            МФИ Софт|  12878.0|Старший инженер-п...|        20|         5|      2021|Программирование....|          0|        0|senior|        |          c++:linux|full|   flexible|<p><strong>МФИ Со...| 56.29008|43.985532|     lib|
|44461719|    nn|               |          ЭР-Телеком|  44272.0|Руководитель прое...|        11|         5|      2021|Управление проект...|          0|        0|junior|        |                sap|full|    fullDay|<p><strong>Функци...|         |         |  manage|
|44498002|    nn|               |Железов Артем Сер...|4642647.0|Cloud Engineering...|        11|         5|      2021|Компьютерная безо...|     250000|   500000|middle|     RUR|architect:aws:cloud|full|     remote|<p><strong>Привет...|         |         |     dsa|
|44743340|    nn|      Дзержинск|          Ростелеком|   2748.0|Техник по подключ...|        20|         5|      2021|Сервисный инженер...|      30000|        0|intern|     RUR|                   |full|    fullDay|<p><strong>Ростел...|56.249061| 43.46123| service|
|42543706|    nn|               |          Devexperts|  52729.0|Специалист технич...|        28|         5|      2021| Поддержка. Helpdesk|          0|        0|junior|        |            fintech|full|     remote|<p><strong>Мы</st...|         |         |    help|
|41763740|    nn|               |       Смарт-Контакт|1813879.0|    Java-разработчик|        18|         5|      2021|Программирование....|          0|        0|senior|        |        java:spring|full|     remote|<p>На текущий мом...|         |         |      ee|
|44183188|    nn|               |         Союзрешение|4652608.0|Программист-разра...|        26|         4|      2021|Программирование....|      84000|   117600|middle|     RUR|                 1c|part|     remote|<p>Мы. компания С...|         |         |  integr|
|44330398|    nn|               |              Skyeng|1122462.0|      Куратор Skypro|        30|         4|      2021| Поддержка. Helpdesk|      30000|    50000|junior|     RUR|                   |full|     remote|<p>В команду <str...|         |         |     out|
|44951418|    nn|Нижний Новгород|               НИТЭК| 735972.0|Младший программи...|        27|         5|      2021|Начальный уровень...|      30000|        0|junior|     RUR|                 1c|full|    fullDay|<strong>Обязаннос...|56.344895|43.898269|  integr|
|44974710|    nn|               |      Антигравитация|2639962.0|Менеджер по прода...|        28|         5|      2021|Начальный уровень...|      45000|        0|junior|     RUR|                crm|full|     remote|<p>Ищем <strong>М...|         |         |   sales|
|43276255|    nn|Нижний Новгород|         КТБ Эксперт|5206622.0|Руководитель груп...|        27|         5|      2021|Языки:Письменный ...|          0|        0|junior|        |                   |full|    fullDay|<strong>Обязаннос...|56.244955|43.972425|     out|
|43512112|    nn|               |      ЛинкТелеком НН|1146834.0|Системный админис...|        31|         5|      2021|Сетевые технологи...|      60000|        0|middle|     RUR|               voip|full|    fullDay|<strong>Обязаннос...|         |         |   admin|
|44908482|    nn|               |      МетМашКомплект|5156170.0|Оператор обрабаты...|        26|         5|      2021|Машиностроение:Ин...|          0|    94000|junior|     RUR|                   |full|flyInFlyOut|<p>На крупное маш...|         |         |engineer|
|42632487|    nn|               |          Доктор Веб|   8884.0|Региональный мене...|        31|         5|      2021|Компьютерные прог...|      40000|        0|junior|     RUR|                   |full|    fullDay|<strong>Обязаннос...|         |         |   sales|
|43761055|    nn|Нижний Новгород|РОСБАНК. Societe ...|    599.0|       Разработчик C|        25|         5|      2021|Программирование....|          0|        0|junior|        |                  c|full|    fullDay|<strong>Обязаннос...|56.307302|44.079855|   multi|
|39731593|    nn|Нижний Новгород|             Biglion| 656481.0|Менеджер по разви...|        27|         5|      2021|Услуги для бизнес...|      50000|        0|intern|     RUR|                   |full|    fullDay|<p><br /><br /><s...|56.311331|44.030088|   sales|
|40893554|    nn|     село Усады|        ICL Services| 156424.0|Системный админис...|        12|         5|      2021|Системный админис...|          0|        0|junior|        |          c:windows|full|     remote|<p><em>В команду ...|55.673087|49.213826|   admin|
|44389738|    nn|Нижний Новгород|                 МТС|   3776.0|Специалист технич...|        11|         5|      2021|Информационные те...|          0|        0|intern|        |                   |full|      shift|<p><strong>МТС – ...|56.293956|44.023728|    help|
+--------+------+---------------+--------------------+---------+--------------------+----------+----------+----------+--------------------+-----------+---------+------+--------+-------------------+----+-----------+--------------------+---------+---------+--------+
only showing top 20 rows
[2021-09-30 19:28:34,343] {logging_mixin.py:104} INFO - 
[2021-09-30 19:28:41,109] {logging_mixin.py:104} INFO - +---------+---------------+
| category|count(category)|
+---------+---------------+
|     null|              0|
|    admin|          13716|
|   analit|           4086|
|      arh|            738|
| category|             18|
|       db|           1710|
|   design|           2610|
|   devops|           3078|
|  digital|           6102|
|      dsa|           7488|
|       ee|           5076|
| engineer|          16542|
|hb_manage|           2340|
|     help|           5850|
|   help_1|           4950|
|   help_2|             36|
|   integr|          13140|
|      lib|           2304|
|   manage|           3636|
|   mobile|           4590|
+---------+---------------+
only showing top 20 rows
[2021-09-30 19:28:41,112] {logging_mixin.py:104} INFO - 
[2021-09-30 19:28:46,315] {logging_mixin.py:104} INFO - +------+----------+
|   exp|count(exp)|
+------+----------+
|intern|      1170|
|junior|      9036|
|middle|      7506|
|senior|      2196|
+------+----------+
[2021-09-30 19:28:46,315] {logging_mixin.py:104} INFO - 
[2021-09-30 19:28:52,178] {logging_mixin.py:104} INFO - +--------------------+-----------+
|                name|count(name)|
+--------------------+-----------+
|              Яндекс|       6804|
|                 МТС|       3924|
|              Билайн|       3456|
|Центр разработки ...|       2700|
|          Ростелеком|       2268|
|Netcracker Techno...|       2232|
|   Intel Corporation|       1494|
|Кадровое агентств...|       1422|
|               ЛАНИТ|       1368|
|              Auriga|       1350|
|            Гринатом|       1278|
|            Сбербанк|       1242|
|        IT_Selection|       1242|
|              Skyeng|       1224|
|                 ГАЗ|       1224|
|                 IBS|       1134|
|          ЭР-Телеком|       1062|
|             МегаФон|        990|
|Positive Technolo...|        954|
|                 ЛАД|        918|
+--------------------+-----------+
only showing top 20 rows
[2021-09-30 19:28:52,178] {logging_mixin.py:104} INFO - 
[2021-09-30 19:28:56,569] {logging_mixin.py:104} INFO - +----------------------------------------------+---------------------------------------------+----------------------------------------------+
|percentile(salary_to, CAST(0.25 AS DOUBLE), 1)|percentile(salary_to, CAST(0.5 AS DOUBLE), 1)|percentile(salary_to, CAST(0.75 AS DOUBLE), 1)|
+----------------------------------------------+---------------------------------------------+----------------------------------------------+
|                                       50000.0|                                      80000.0|                                      120000.0|
|                                       60000.0|                                      91000.0|                                      150000.0|
|                                      130000.0|                                     150000.0|                                      200000.0|
|                                      100000.0|                                     200000.0|                                      250000.0|
+----------------------------------------------+---------------------------------------------+----------------------------------------------+
[2021-09-30 19:28:56,569] {logging_mixin.py:104} INFO - 
[2021-09-30 19:28:56,569] {python.py:151} INFO - Done. Returned value was: None
[2021-09-30 19:28:56,593] {taskinstance.py:1204} INFO - Marking task as SUCCESS. dag_id=etl_dag, task_id=run_hive, execution_date=20210928T000000, start_date=20210930T162805, end_date=20210930T162856
[2021-09-30 19:28:56,692] {local_task_job.py:197} WARNING - State of this instance has been externally set to success. Terminating instance.
[2021-09-30 19:28:56,712] {process_utils.py:100} INFO - Sending Signals.SIGTERM to GPID 1716256
[2021-09-30 19:28:56,843] {taskinstance.py:1284} ERROR - Received SIGTERM. Terminating subprocesses.
[2021-09-30 19:28:56,889] {process_utils.py:66} INFO - Process psutil.Process(pid=1716256, status='terminated', exitcode=1, started='19:28:05') (1716256) terminated with exit code 1
[2021-09-30 19:28:57,424] {process_utils.py:66} INFO - Process psutil.Process(pid=1716273, status='terminated', started='19:28:05') (1716273) terminated with exit code None
